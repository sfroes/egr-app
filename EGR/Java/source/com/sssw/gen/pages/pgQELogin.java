// *** Generated Source File ***
// Portions Copyright (c) 1996-2001, SilverStream Software, Inc., All Rights Reserved

package com.sssw.gen.pages; // generated by SilverStream: do not edit

import java.awt.*;
import java.util.*;
import java.math.*;
import com.sssw.rt.gui.*;
import com.sssw.rt.util.*;
import com.sssw.rt.event.*;
import java.awt.event.*;
import com.sssw.rt.expr.*;
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import com.sssw.shr.page.*;
import com.sssw.shr.http.AgiHttpServletRequest;
import com.sssw.shr.http.AgiHttpServletResponse;
import com.sssw.shr.http.AgoServletException;
import com.sssw.srv.api.*;
import com.sssw.srv.busobj.*;
import com.sssw.srv.mail.*;

public class pgQELogin extends AgpPage // generated by SilverStream: do not edit
	
	implements AgiPageActionListener
{

	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	public com.sssw.shr.page.AgpData	agpCurso;
	public com.sssw.shr.page.AgpChoice	cbCursos;
	
	
	public com.sssw.shr.page.AgpTextField	fldNome;
	public com.sssw.shr.page.AgpTextField	fldCod_aluno;
	public com.sssw.shr.page.AgpTextField	fldDataNasc;
	
	public com.sssw.shr.page.AgpTextField	fldAno;
	public com.sssw.shr.page.AgpChoice	chcSemeste;
	public com.sssw.shr.page.AgpChoice	chcTurno;
	public com.sssw.shr.page.AgpButtonText	btnOK;
	public com.sssw.shr.page.AgpData	agpData1;
	
	
	
	
	
	
	
	
	
	
	
	String sSISTEMA = "";
	String sPAGINA = "";
	public com.sssw.gen.pages.pgPadraoCabecalho	pgPadraoCabecalho;
	public com.sssw.shr.page.AgpTable	tabMolduraCentral;
	
	public pgQELogin()
	{
		//==== Warning: SilverStream-generated method: do not edit. All changes will be lost ===
	}

	public void init() throws Exception
	{
		//==== Warning: SilverStream-generated method: do not edit. All changes will be lost ===
		agData.setDataMode(AgoData.DATA_MODE_NORMAL);
		// Initialize tabMolduraCentral
			tabMolduraCentral = (com.sssw.shr.page.AgpTable) getControl("tabMolduraCentral");
		// Initialize pgPadraoCabecalho
			pgPadraoCabecalho = (com.sssw.gen.pages.pgPadraoCabecalho) getControl("pgPadraoCabecalho");
		// Initialize agpData1
			agpData1 = (com.sssw.shr.page.AgpData) getControl("agpData1");
			agpData1.setName("agpData1");
			agpData1.setExpressionCount(2);
			agpData1.setExpression(0, 0, "cod_turno", 0);
			agpData1.setExpression(1, 1, "dsc_turno", 1);
		// Initialize btnOK
			btnOK = (com.sssw.shr.page.AgpButtonText) getControl("btnOK");
		// Initialize fldNome
			fldNome = (com.sssw.shr.page.AgpTextField) getControl("fldNome");
			fldNome.setDatatype(DatatypeCodes.TYPE_STRING);
		// Initialize fldCod_aluno
			fldCod_aluno = (com.sssw.shr.page.AgpTextField) getControl("fldCod_aluno");
			fldCod_aluno.setDatatype(DatatypeCodes.TYPE_STRING);
		// Initialize fldDataNasc
			fldDataNasc = (com.sssw.shr.page.AgpTextField) getControl("fldDataNasc");
			fldDataNasc.setDatatype(DatatypeCodes.TYPE_STRING);
		// Initialize fldAno
			fldAno = (com.sssw.shr.page.AgpTextField) getControl("fldAno");
			fldAno.setDatatype(DatatypeCodes.TYPE_STRING);
		// Initialize chcSemeste
			chcSemeste = (com.sssw.shr.page.AgpChoice) getControl("chcSemeste");
			chcSemeste.add("Primeiro", "1");
			chcSemeste.add("Segundo", "2");
		// Initialize chcTurno
			chcTurno = (com.sssw.shr.page.AgpChoice) getControl("chcTurno");
			chcTurno.setDisplayExpression(2);
			chcTurno.setValueExpression(3);
			chcTurno.setAutomaticQuery(true);
		// Initialize cbCursos
			cbCursos = (com.sssw.shr.page.AgpChoice) getControl("cbCursos");
		// Initialize agpCurso
			agpCurso = (com.sssw.shr.page.AgpData) getControl("agpCurso");
			agpCurso.setName("agpCurso");
			agpCurso.setExpressionCount(2);
			agpCurso.setExpression(0, 4, "cod_curso_oferta", 0);
			agpCurso.setExpression(1, 5, "nom_curso", 1);

		addChildren();

		addBindings();

		return;
	}

	private void addChildren()
	{
		//==== Warning: SilverStream-generated method: do not edit. All changes will be lost ===
		btnOK.addPageActionListener(this);
	}

	protected void addBindings()
	{
		//==== Warning: SilverStream-generated method: do not edit. All changes will be lost ===
		addExpDependencies();
	}

	
protected void pageRequestEnd(AgiHttpServletRequest req, AgiHttpServletResponse res) throws Exception
	{
		// Configura o controle de cache
		Hashtable hs = new Hashtable();		
		hs.put("response", res);
		invokeBusinessObject("Util:boCacheConfig", hs);
	}











protected void pageLoaded(AgiHttpServletRequest req, AgiHttpServletResponse res) throws Exception
	{
	try
	{	
		sSISTEMA = getDatabase() + " - ";	
		sPAGINA = getPath().substring(getPath().lastIndexOf('/') + 1, getPath().lastIndexOf('.'));
    
        removeSessionValue("vsCodAluno");
		btnOK.setProperty("CLASS", "botao");
		tabMolduraCentral.setProperty("CLASS", "borda");
		
		chcSemeste.insert(" -= Semestre =-", 0);
		chcTurno.insert(" ", 0);


		/* Carrega somente os cursos a serem avaliados */
		
		StringBuffer sbCursos = new StringBuffer();
		
		sbCursos.append("vw_ss_curso.cod_curso_oferta = 5"); 		//  Odontologia - NÚCLEO UNIV BH
		sbCursos.append(" or vw_ss_curso.cod_curso_oferta = 20");	//	Administração - NÚCLEO UNIV BH
		sbCursos.append(" or vw_ss_curso.cod_curso_oferta = 38");	//	Relações Internacionais - NÚCLEO UNIV BH

		agpCurso.query("" + sbCursos.toString());

		cbCursos.insert("-= CURSOS / UNIDADES =-", 0);

		if (agpCurso.gotoFirst())
		{
			do
			{
				cbCursos.add("" + agpCurso.getProperty("nom_curso"), (Integer)agpCurso.getProperty("cod_curso_oferta"));
			} while (agpCurso.gotoNext());
		}


         
	}
	catch(Exception e)
	{
		String sMETODO = " - pageLoaded";

		// CHAMA boEnivaMsgConsole
		Hashtable hs = new Hashtable();
		hs.put("pIdentificador", sSISTEMA + sPAGINA + sMETODO);
		hs.put("pException", e);
		invokeBusinessObject("Util:boEnviaMsgConsole", hs);
	}
	}

	public void pageActionPerformed(ActionEvent evt) throws Exception
	{
		//==== Warning: SilverStream-generated method: do not edit. All changes will be lost ===
		Object src = evt.getSource();
		if (src == btnOK)
		{
			handle_btnOK_pageActionPerformed(evt);
			return;
		}
	}



protected void pageRequestBegin(AgiHttpServletRequest req, AgiHttpServletResponse res) throws Exception
	{
		limpa();    // limpa os campos e limpa a sessão
		writeScript ("Page.fldNome.focus(); Page.fldNome.select(); ");
	}

	





public void limpa()
		throws Exception
	{
		fldAno.setText("");
		fldNome.setText("");
		fldCod_aluno.setText("");
		fldDataNasc.setText("");

		removeSessionValue("vsCodAluno");
		removeSessionValue("vsNomeAluno");
		removeSessionValue("vsDataNasc");
		removeSessionValue("vsCodCursoOferta");
		removeSessionValue("vsAno");
		removeSessionValue("vsSemestre");
		removeSessionValue("vsTurno");

	}

	public Object ag_getValue(DataCursor cursor, int valueID, Object param1, Object param2)
	{
		//==== Warning: SilverStream-generated method: do not edit. All changes will be lost ===
		try
		{
			switch (valueID)
			{
				case 0:
					/* cod_turno () vw_ss_turno.cod_turno*/
					return ((Short) cursor.getProperty(0));

				case 1:
					/* dsc_turno () vw_ss_turno.dsc_turno*/
					return ((String) cursor.getProperty(1));

				case 2:
					/* chcTurno () vw_ss_turno.dsc_turno*/
					return ((String) cursor.getProperty(0));

				case 3:
					/* chcTurno () vw_ss_turno.cod_turno*/
					return ((Short) cursor.getProperty(1));

				case 4:
					/* cod_curso_oferta () vw_ss_curso.cod_curso_oferta*/
					return ((Integer) cursor.getProperty(0));

				case 5:
					/* nom_curso () vw_ss_curso.nom_curso*/
					return ((String) cursor.getProperty(1));

				default:
					return null;
			}
		}
		catch (Throwable e)
		{
			return null;
		}
	}
	
	










private void handle_btnOK_pageActionPerformed(ActionEvent evt)
		throws Exception
	
	{
	try
	{	

		if (! fldNome.getText().trim().equals(""));
			setSessionValue("vsNomeAluno", fldNome.getText() );

		if (! fldCod_aluno.getText().trim().equals(""));
			setSessionValue("vsCodAluno", fldCod_aluno.getText());	
	
		if (! fldDataNasc.getText().trim().equals(""));
			setSessionValue("vsDataNasc",fldDataNasc.getText() );

		if (! fldAno.getText().trim().equals(""));
			setSessionValue("vsAno",fldAno.getText() );

		if (cbCursos.getSelectedIndex() > 0)
			setSessionValue("vsCodCursoOferta", cbCursos.getValue());

		if (chcSemeste.getSelectedIndex() > 0)
			setSessionValue("vsSemestre", chcSemeste.getValue());

		if (chcTurno.getSelectedIndex() > 0)
			setSessionValue("vsTurno", chcTurno.getValue());	

		showPage("pgQEDefineAluno.html"); 
//		showPage("pgQEMsgPesquisa.html"); 

	}
	catch(Exception e)
	{
		String sMETODO = " - btnOk.pageActionPerformec";

		// CHAMA boEnivaMsgConsole
		Hashtable hs = new Hashtable();
		hs.put("pIdentificador", sSISTEMA + sPAGINA + sMETODO);
		hs.put("pException", e);
		invokeBusinessObject("Util:boEnviaMsgConsole", hs);
	}

	}

}
