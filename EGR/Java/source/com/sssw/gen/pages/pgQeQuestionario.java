// *** Generated Source File ***
// Portions Copyright (c) 1996-2001, SilverStream Software, Inc., All Rights Reserved

package com.sssw.gen.pages; // generated by SilverStream: do not edit

import java.awt.*;
import java.util.*;
import java.math.*;
import com.sssw.rt.gui.*;
import com.sssw.rt.util.*;
import com.sssw.rt.event.*;
import java.awt.event.*;
import com.sssw.rt.expr.*;
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import com.sssw.shr.page.*;
import com.sssw.shr.http.AgiHttpServletRequest;
import com.sssw.shr.http.AgiHttpServletResponse;
import com.sssw.shr.http.AgoServletException;
import com.sssw.srv.api.*;
import com.sssw.srv.busobj.*;
import com.sssw.srv.mail.*;

public class pgQeQuestionario extends AgpPage // generated by SilverStream: do not edit
	implements AgiPageActionListener
{
	
	
	
	
	
	
	
	public com.sssw.shr.page.AgpLabel	lblQuestaoMultiploCampoAbertoPreenchido;
	public com.sssw.shr.page.AgpLabel	lblQuestaoMultiploCampoAberto;
	public com.sssw.shr.page.AgpTextField	fldQrCodPer;
	public com.sssw.shr.page.AgpTextField	fldQnrCodPer;
	
	public com.sssw.shr.page.AgpButtonText	brnsalvar;
	public com.sssw.shr.page.AgpLabel	lbQnR_CodAluno;
	public com.sssw.shr.page.AgpLabel	lblQnR_Op;
	public com.sssw.shr.page.AgpLabel	lblQnR_DscResp;
	public com.sssw.shr.page.AgpLabel	lblQnR_SeqResp;
	public com.sssw.shr.page.AgpLabel	lblQnR_Aberta;
	public com.sssw.shr.page.AgpLabel	lblQnRTxt;
	public com.sssw.shr.page.AgpLabel	lblQnR_QtdResp;
	public com.sssw.shr.page.AgpLabel	lblQnR_SeqPer;
	public com.sssw.shr.page.AgpLabel	Label8;
	public com.sssw.shr.page.AgpLabel	lblQnR_SeqResp01;
	public com.sssw.shr.page.AgpLabel	lblQnR_CodQuestionario;
	public com.sssw.shr.page.AgpViewPanel	dvQuestNaoRespondidoPerguntas;
	public com.sssw.shr.page.AgpViewPanel	dvQuestNaoRespondidoRespostas;
	
	public com.sssw.shr.page.AgpLabel	lblQnR_SeqPer00;
	public com.sssw.shr.page.AgpLabel	lblQnR_SeqQuest;
	public com.sssw.shr.page.AgpLabel	lblQnR_DscPergunta;
	public com.sssw.shr.page.AgpTextField	lblQnResp_QtdResp;
	public com.sssw.shr.page.AgpLabel	lblQRTxt;
	public com.sssw.shr.page.AgpLabel	lblQR_CodQuestionario;
	public com.sssw.shr.page.AgpLabel	lbQR_CodAluno;
	public com.sssw.shr.page.AgpData	agpDataPerguntaRespostaAux;
	public com.sssw.shr.page.AgpViewPanel	dvQuestRespondidoRespostas;
	public com.sssw.shr.page.AgpLabel	lblQR_Op;
	public com.sssw.shr.page.AgpLabel	lblQR_DscResp;
	public com.sssw.shr.page.AgpLabel	lblQR_SeqResp;
	public com.sssw.shr.page.AgpLabel	lblQR_Aberta;
	public com.sssw.shr.page.AgpLabel	lblQR_QtdResp;
	public com.sssw.shr.page.AgpLabel	lblQR_SeqPer;
	public com.sssw.shr.page.AgpLabel	lblQR_SeqResp01;
	
	public com.sssw.shr.page.AgpLabel	lblQR_SeqPer00;
	public com.sssw.shr.page.AgpLabel	lblQR_SeqQuest;
	public com.sssw.shr.page.AgpLabel	lblQR_DscPergunta;
	public com.sssw.shr.page.AgpTextField	lblQResp_QtdResp;
	public com.sssw.shr.page.AgpViewPanel	dvQuestRespondidoPerguntas;
	public com.sssw.shr.page.AgpTable	tabQuestRespondido;
	public com.sssw.shr.page.AgpTable	tabQuestNMaoRespondido;
	
	
	
	public com.sssw.shr.page.AgpLabel	lblNome;
	
	
	
	
	public com.sssw.shr.page.AgpData	agpPerguntaResposta;
	
	
	
	
	
	
	
	
	
	
	
	
	public com.sssw.shr.page.AgpTable	tabMolduraCentral;
	public com.sssw.gen.pages.pgPadraoCabecalho	pgPadraoCabecalho;
	
	public com.sssw.shr.page.AgpData	agpRespostas;
	public com.sssw.shr.page.AgpData	agpPergunta;
	
	
	
	
	
	String sSISTEMA = "";
	String sPAGINA = "";
	

	public pgQeQuestionario()
	{
		//==== Warning: SilverStream-generated method: do not edit. All changes will be lost ===
	} 
	public void init() throws Exception
	{
		//==== Warning: SilverStream-generated method: do not edit. All changes will be lost ===
		agData.setDataMode(AgoData.DATA_MODE_NORMAL);
		// Initialize tabMolduraCentral
			tabMolduraCentral = (com.sssw.shr.page.AgpTable) getControl("tabMolduraCentral");
		// Initialize pgPadraoCabecalho
			pgPadraoCabecalho = (com.sssw.gen.pages.pgPadraoCabecalho) getControl("pgPadraoCabecalho");
		// Initialize agpRespostas
			agpRespostas = (com.sssw.shr.page.AgpData) getControl("agpRespostas");
			agpRespostas.setName("agpRespostas");
			agpRespostas.setExpressionCount(4);
			agpRespostas.setExpression(0, 0, "seq_resp", 0);
			agpRespostas.setExpression(1, 1, "cod_questionario", 1);
			agpRespostas.setExpression(2, 2, "seq_per", 2);
			agpRespostas.setExpression(3, 3, "dsc_resposta", 3);
		// Initialize agpPergunta
			agpPergunta = (com.sssw.shr.page.AgpData) getControl("agpPergunta");
			agpPergunta.setName("agpPergunta");
			agpPergunta.setExpressionCount(4);
			agpPergunta.setExpression(0, 4, "dsc_pergunta", 0);
			agpPergunta.setExpression(1, 5, "qtd_resp", 1);
			agpPergunta.setExpression(2, 6, "questionario_cod_questionario", 2);
			agpPergunta.setExpression(3, 7, "seq_per", 3);
		// Initialize agpPerguntaResposta
			agpPerguntaResposta = (com.sssw.shr.page.AgpData) getControl("agpPerguntaResposta");
			agpPerguntaResposta.setName("agpPerguntaResposta");
			agpPerguntaResposta.setExpressionCount(6);
			agpPerguntaResposta.setExpression(0, 8, "cod_aluno", 0);
			agpPerguntaResposta.setExpression(1, 9, "cod_seq", 1);
			agpPerguntaResposta.setExpression(2, 10, "questionario_cod_questionario", 2);
			agpPerguntaResposta.setExpression(3, 11, "pergunta_seq_per", 3);
			agpPerguntaResposta.setExpression(4, 12, "resposta_seq_resp", 4);
			agpPerguntaResposta.setExpression(5, 13, "dsc_resp", 5);
		// Initialize lblNome
			lblNome = (com.sssw.shr.page.AgpLabel) getControl("lblNome");
		// Initialize tabQuestRespondido
			tabQuestRespondido = (com.sssw.shr.page.AgpTable) getControl("tabQuestRespondido");
		// Initialize tabQuestNMaoRespondido
			tabQuestNMaoRespondido = (com.sssw.shr.page.AgpTable) getControl("tabQuestNMaoRespondido");
		// Initialize dvQuestRespondidoPerguntas
			dvQuestRespondidoPerguntas = (com.sssw.shr.page.AgpViewPanel) getControl("dvQuestRespondidoPerguntas");
			dvQuestRespondidoPerguntas.setName("dvQuestRespondidoPerguntas");
		// Initialize lblQR_SeqPer00
			lblQR_SeqPer00 = (com.sssw.shr.page.AgpLabel) getControl("lblQR_SeqPer00");
		// Initialize lblQR_SeqQuest
			lblQR_SeqQuest = (com.sssw.shr.page.AgpLabel) getControl("lblQR_SeqQuest");
		// Initialize lblQR_DscPergunta
			lblQR_DscPergunta = (com.sssw.shr.page.AgpLabel) getControl("lblQR_DscPergunta");
		// Initialize lblQResp_QtdResp
			lblQResp_QtdResp = (com.sssw.shr.page.AgpTextField) getControl("lblQResp_QtdResp");
			lblQResp_QtdResp.setDatatype(DatatypeCodes.TYPE_STRING);
		// Initialize dvQuestRespondidoRespostas
			dvQuestRespondidoRespostas = (com.sssw.shr.page.AgpViewPanel) getControl("dvQuestRespondidoRespostas");
			dvQuestRespondidoRespostas.setName("dvQuestRespondidoRespostas");
		// Initialize lblQR_Op
			lblQR_Op = (com.sssw.shr.page.AgpLabel) getControl("lblQR_Op");
		// Initialize lblQR_DscResp
			lblQR_DscResp = (com.sssw.shr.page.AgpLabel) getControl("lblQR_DscResp");
		// Initialize lblQR_SeqResp
			lblQR_SeqResp = (com.sssw.shr.page.AgpLabel) getControl("lblQR_SeqResp");
		// Initialize lblQR_Aberta
			lblQR_Aberta = (com.sssw.shr.page.AgpLabel) getControl("lblQR_Aberta");
		// Initialize lblQR_QtdResp
			lblQR_QtdResp = (com.sssw.shr.page.AgpLabel) getControl("lblQR_QtdResp");
		// Initialize lblQR_SeqPer
			lblQR_SeqPer = (com.sssw.shr.page.AgpLabel) getControl("lblQR_SeqPer");
		// Initialize lblQR_SeqResp01
			lblQR_SeqResp01 = (com.sssw.shr.page.AgpLabel) getControl("lblQR_SeqResp01");
		// Initialize agpDataPerguntaRespostaAux
			agpDataPerguntaRespostaAux = (com.sssw.shr.page.AgpData) getControl("agpDataPerguntaRespostaAux");
			agpDataPerguntaRespostaAux.setName("agpDataPerguntaRespostaAux");
			agpDataPerguntaRespostaAux.setExpressionCount(2);
			agpDataPerguntaRespostaAux.setExpression(0, 14, "questionario_cod_questionario", 0);
			agpDataPerguntaRespostaAux.setExpression(1, 15, "cod_aluno", 1);
		// Initialize lblQR_CodQuestionario
			lblQR_CodQuestionario = (com.sssw.shr.page.AgpLabel) getControl("lblQR_CodQuestionario");
		// Initialize lbQR_CodAluno
			lbQR_CodAluno = (com.sssw.shr.page.AgpLabel) getControl("lbQR_CodAluno");
		// Initialize lblQRTxt
			lblQRTxt = (com.sssw.shr.page.AgpLabel) getControl("lblQRTxt");
		// Initialize dvQuestNaoRespondidoPerguntas
			dvQuestNaoRespondidoPerguntas = (com.sssw.shr.page.AgpViewPanel) getControl("dvQuestNaoRespondidoPerguntas");
			dvQuestNaoRespondidoPerguntas.setName("dvQuestNaoRespondidoPerguntas");
		// Initialize lblQnR_SeqPer00
			lblQnR_SeqPer00 = (com.sssw.shr.page.AgpLabel) getControl("lblQnR_SeqPer00");
		// Initialize lblQnR_SeqQuest
			lblQnR_SeqQuest = (com.sssw.shr.page.AgpLabel) getControl("lblQnR_SeqQuest");
		// Initialize lblQnR_DscPergunta
			lblQnR_DscPergunta = (com.sssw.shr.page.AgpLabel) getControl("lblQnR_DscPergunta");
		// Initialize lblQnResp_QtdResp
			lblQnResp_QtdResp = (com.sssw.shr.page.AgpTextField) getControl("lblQnResp_QtdResp");
			lblQnResp_QtdResp.setDatatype(DatatypeCodes.TYPE_STRING);
		// Initialize dvQuestNaoRespondidoRespostas
			dvQuestNaoRespondidoRespostas = (com.sssw.shr.page.AgpViewPanel) getControl("dvQuestNaoRespondidoRespostas");
			dvQuestNaoRespondidoRespostas.setName("dvQuestNaoRespondidoRespostas");
		// Initialize lblQnR_Op
			lblQnR_Op = (com.sssw.shr.page.AgpLabel) getControl("lblQnR_Op");
		// Initialize lblQnR_DscResp
			lblQnR_DscResp = (com.sssw.shr.page.AgpLabel) getControl("lblQnR_DscResp");
		// Initialize lblQnR_SeqResp
			lblQnR_SeqResp = (com.sssw.shr.page.AgpLabel) getControl("lblQnR_SeqResp");
		// Initialize lblQnR_Aberta
			lblQnR_Aberta = (com.sssw.shr.page.AgpLabel) getControl("lblQnR_Aberta");
		// Initialize lblQnRTxt
			lblQnRTxt = (com.sssw.shr.page.AgpLabel) getControl("lblQnRTxt");
		// Initialize lblQnR_QtdResp
			lblQnR_QtdResp = (com.sssw.shr.page.AgpLabel) getControl("lblQnR_QtdResp");
		// Initialize lblQnR_SeqPer
			lblQnR_SeqPer = (com.sssw.shr.page.AgpLabel) getControl("lblQnR_SeqPer");
		// Initialize Label8
			Label8 = (com.sssw.shr.page.AgpLabel) getControl("Label8");
		// Initialize lblQnR_SeqResp01
			lblQnR_SeqResp01 = (com.sssw.shr.page.AgpLabel) getControl("lblQnR_SeqResp01");
		// Initialize lblQnR_CodQuestionario
			lblQnR_CodQuestionario = (com.sssw.shr.page.AgpLabel) getControl("lblQnR_CodQuestionario");
		// Initialize lbQnR_CodAluno
			lbQnR_CodAluno = (com.sssw.shr.page.AgpLabel) getControl("lbQnR_CodAluno");
		// Initialize brnsalvar
			brnsalvar = (com.sssw.shr.page.AgpButtonText) getControl("brnsalvar");
		// Initialize fldQnrCodPer
			fldQnrCodPer = (com.sssw.shr.page.AgpTextField) getControl("fldQnrCodPer");
			fldQnrCodPer.setDatatype(DatatypeCodes.TYPE_STRING);
		// Initialize fldQrCodPer
			fldQrCodPer = (com.sssw.shr.page.AgpTextField) getControl("fldQrCodPer");
			fldQrCodPer.setDatatype(DatatypeCodes.TYPE_STRING);
		// Initialize lblQuestaoMultiploCampoAbertoPreenchido
			lblQuestaoMultiploCampoAbertoPreenchido = (com.sssw.shr.page.AgpLabel) getControl("lblQuestaoMultiploCampoAbertoPreenchido");
		// Initialize lblQuestaoMultiploCampoAberto
			lblQuestaoMultiploCampoAberto = (com.sssw.shr.page.AgpLabel) getControl("lblQuestaoMultiploCampoAberto");

		addChildren();

		addBindings();

		return;
	}
	private void addChildren()
	{
		//==== Warning: SilverStream-generated method: do not edit. All changes will be lost ===
		brnsalvar.addPageActionListener(this);
	}
	protected void addBindings()
	{
		//==== Warning: SilverStream-generated method: do not edit. All changes will be lost ===
		agDataMgr.bindToExp(lblQR_SeqPer00, "TEXT", "getText", "setText", 16);
		agDataMgr.bindToExp(lblQR_SeqQuest, "TEXT", "getText", "setText", 17);
		agDataMgr.bindToExp(lblQR_DscPergunta, "TEXT", "getText", "setText", 18);
		agDataMgr.bind(lblQResp_QtdResp, "Value", "getText", "setText", dvQuestRespondidoPerguntas, "Column3");
		Object SubformLink3[] = {
			dvQuestRespondidoPerguntas, new Integer(0)};
		agDataMgr.linkBind(dvQuestRespondidoRespostas, "vw_ss_respostas_preenchidas.seq_per = %0%", SubformLink3);
		agDataMgr.bindToExp(lblQR_Op, "TEXT", "getText", "setText", 19);
		agDataMgr.bindToExp(lblQR_DscResp, "TEXT", "getText", "setText", 20);
		agDataMgr.bindToExp(lblQR_SeqResp, "TEXT", "getText", "setText", 21);
		agDataMgr.bindToExp(lblQR_Aberta, "TEXT", "getText", "setText", 22);
		agDataMgr.bindToExp(lblQR_QtdResp, "TEXT", "getText", "setText", 23);
		agDataMgr.bindToExp(lblQR_SeqPer, "TEXT", "getText", "setText", 24);
		agDataMgr.bindToExp(lblQR_SeqResp01, "TEXT", "getText", "setText", 25);
		agDataMgr.bindToExp(lblQR_CodQuestionario, "TEXT", "getText", "setText", 26);
		agDataMgr.bindToExp(lbQR_CodAluno, "TEXT", "getText", "setText", 27);
		agDataMgr.bindToExp(lblQnR_SeqPer00, "TEXT", "getText", "setText", 28);
		agDataMgr.bindToExp(lblQnR_SeqQuest, "TEXT", "getText", "setText", 29);
		agDataMgr.bindToExp(lblQnR_DscPergunta, "TEXT", "getText", "setText", 30);
		agDataMgr.bind(lblQnResp_QtdResp, "Value", "getText", "setText", dvQuestNaoRespondidoPerguntas, "Column2");
		Object SubformLink4[] = {
			dvQuestNaoRespondidoPerguntas, new Integer(0)};
		agDataMgr.linkBind(dvQuestNaoRespondidoRespostas, "%0% = vw_ss_respostas_nao_preenchidas.seq_per", SubformLink4);
		agDataMgr.bindToExp(lblQnR_Op, "TEXT", "getText", "setText", 31);
		agDataMgr.bindToExp(lblQnR_DscResp, "TEXT", "getText", "setText", 32);
		agDataMgr.bindToExp(lblQnR_SeqResp, "TEXT", "getText", "setText", 33);
		agDataMgr.bindToExp(lblQnR_Aberta, "TEXT", "getText", "setText", 34);
		agDataMgr.bindToExp(lblQnR_QtdResp, "TEXT", "getText", "setText", 35);
		agDataMgr.bindToExp(lblQnR_SeqPer, "TEXT", "getText", "setText", 36);
		agDataMgr.bindToExp(lblQnR_SeqResp01, "TEXT", "getText", "setText", 37);
		agDataMgr.bindToExp(lblQnR_CodQuestionario, "TEXT", "getText", "setText", 38);
		agDataMgr.bind(fldQnrCodPer, "Value", "getText", "setText", dvQuestNaoRespondidoRespostas, "Column1");
		agDataMgr.bind(fldQrCodPer, "Value", "getText", "setText", dvQuestRespondidoRespostas, "Column0");
		agDataMgr.bindToExp(lblQuestaoMultiploCampoAbertoPreenchido, "TEXT", "getText", "setText", 39);
		agDataMgr.bindToExp(lblQuestaoMultiploCampoAberto, "TEXT", "getText", "setText", 40);
		addExpDependencies();
	}

	
protected void pageRequestEnd(AgiHttpServletRequest req, AgiHttpServletResponse res) throws Exception
	{
		// Configura o controle de cache
		Hashtable hs = new Hashtable();		
		hs.put("response", res);
		invokeBusinessObject("Util:boCacheConfig", hs);
	}






protected void pageLoaded(AgiHttpServletRequest req, AgiHttpServletResponse res) throws Exception
	{
	try
	{	
		sSISTEMA = getDatabase() + " - ";	
		sPAGINA = getPath().substring(getPath().lastIndexOf('/') + 1, getPath().lastIndexOf('.'));

		lblQR_Op.setRawHTMLMode(true);
		lblQR_Aberta.setRawHTMLMode(true);
		lblQuestaoMultiploCampoAberto.setRawHTMLMode(true);
        lblQRTxt.setRawHTMLMode(true);

		lblQnR_Op.setRawHTMLMode(true);
		lblQnR_Aberta.setRawHTMLMode(true);
		lblQuestaoMultiploCampoAbertoPreenchido.setRawHTMLMode(true);
        lblQnRTxt.setRawHTMLMode(true);

		brnsalvar.setProperty("CLASS", "botao");
		tabMolduraCentral.setProperty("CLASS", "borda");

	}
	catch(Exception e)
	{
		String sMETODO = " - pageLoaded";

		// CHAMA boEnivaMsgConsole
		Hashtable hs = new Hashtable();
		hs.put("pIdentificador", sSISTEMA + sPAGINA + sMETODO);
		hs.put("pException", e);
		invokeBusinessObject("Util:boEnviaMsgConsole", hs);
	}

	}	
		public Object ag_getValue(DataCursor cursor, int valueID, Object param1, Object param2)
	{
		//==== Warning: SilverStream-generated method: do not edit. All changes will be lost ===
		try
		{
			switch (valueID)
			{
				case 0:
					/* seq_resp () respostas.seq_resp*/
					return ((Integer) cursor.getProperty(0));

				case 1:
					/* cod_questionario () respostas.cod_questionario*/
					return ((Integer) cursor.getProperty(1));

				case 2:
					/* seq_per () respostas.seq_per*/
					return ((Integer) cursor.getProperty(2));

				case 3:
					/* dsc_resposta () respostas.dsc_resposta*/
					return ((String) cursor.getProperty(3));

				case 4:
					/* dsc_pergunta () pergunta.dsc_pergunta*/
					return ((String) cursor.getProperty(0));

				case 5:
					/* qtd_resp () pergunta.qtd_resp*/
					return ((Integer) cursor.getProperty(1));

				case 6:
					/* questionario_cod_questionario () pergunta.questionario_cod_questionario*/
					return ((Integer) cursor.getProperty(2));

				case 7:
					/* seq_per () pergunta.seq_per*/
					return ((Integer) cursor.getProperty(3));

				case 8:
					/* cod_aluno () pergunta_resposta.cod_aluno*/
					return ((Integer) cursor.getProperty(0));

				case 9:
					/* cod_seq () pergunta_resposta.cod_seq*/
					return ((Integer) cursor.getProperty(1));

				case 10:
					/* questionario_cod_questionario () pergunta_resposta.questionario_cod_questionario*/
					return ((Integer) cursor.getProperty(2));

				case 11:
					/* pergunta_seq_per () pergunta_resposta.pergunta_seq_per*/
					return ((Integer) cursor.getProperty(3));

				case 12:
					/* resposta_seq_resp () pergunta_resposta.resposta_seq_resp*/
					return ((Integer) cursor.getProperty(4));

				case 13:
					/* dsc_resp () pergunta_resposta.dsc_resp*/
					return ((String) cursor.getProperty(5));

				case 14:
					/* questionario_cod_questionario () pergunta_resposta.questionario_cod_questionario*/
					return ((Integer) cursor.getProperty(0));

				case 15:
					/* cod_aluno () pergunta_resposta.cod_aluno*/
					return ((Integer) cursor.getProperty(1));

				case 16:
					/* lblQR_SeqPer00 () pergunta.seq_per*/
					return ((Integer) dvQuestRespondidoPerguntas.getProperty(0));

				case 17:
					/* lblQR_SeqQuest () pergunta.questionario_cod_questionario*/
					return ((Integer) dvQuestRespondidoPerguntas.getProperty(2));

				case 18:
					/* lblQR_DscPergunta () pergunta.dsc_pergunta*/
					return ((String) dvQuestRespondidoPerguntas.getProperty(1));

				case 19:
					/* lblQR_Op () if vw_ss_respostas_preenchidas.qtd_resp <> 0 then if vw_ss_respostas_preenchidas.qtd_resp = 1 then if vw_ss_respostas_preenchidas.resposta_seq_resp isnull then "<INPUT TYPE=\"RADIO\" NAME=\"RB" + vw_ss_respostas_preenchidas.seq_per + "\" VALUE = " + vw_ss_respostas_preenchidas.seq_resp + " UNCHECKED>" else "<INPUT TYPE=\"RADIO\" NAME=\"RB" + vw_ss_respostas_preenchidas.seq_per + "\" VALUE = " + vw_ss_respostas_preenchidas.seq_resp + " CHECKED>" endif else if vw_ss_respostas_preenchidas.resposta_seq_resp isnull then "<INPUT TYPE=\"CHECKBOX\" NAME=\"CB" + vw_ss_respostas_preenchidas.seq_resp + "\" VALUE = " + vw_ss_respostas_preenchidas.seq_resp + " UNCHECKED>" else "<INPUT TYPE=\"CHECKBOX\" NAME=\"CB" + vw_ss_respostas_preenchidas.seq_resp + "\" VALUE = " + vw_ss_respostas_preenchidas.seq_resp + " CHECKED>" endif endif else "" endif*/
					return (((Integer) dvQuestRespondidoRespostas.getProperty(6)).intValue() != 0) ? ((((Integer) dvQuestRespondidoRespostas.getProperty(6)).intValue() == 1) ? (((((Integer) dvQuestRespondidoRespostas.getProperty(7)) == null ? true : false)) ? ((((("<INPUT TYPE=\"RADIO\" NAME=\"RB") + (((Integer) dvQuestRespondidoRespostas.getProperty(0)))) + ("\" VALUE = ")) + (((Integer) dvQuestRespondidoRespostas.getProperty(3)))) + (" UNCHECKED>")) : ((((("<INPUT TYPE=\"RADIO\" NAME=\"RB") + (((Integer) dvQuestRespondidoRespostas.getProperty(0)))) + ("\" VALUE = ")) + (((Integer) dvQuestRespondidoRespostas.getProperty(3)))) + (" CHECKED>"))) : (((((Integer) dvQuestRespondidoRespostas.getProperty(7)) == null ? true : false)) ? ((((("<INPUT TYPE=\"CHECKBOX\" NAME=\"CB") + (((Integer) dvQuestRespondidoRespostas.getProperty(3)))) + ("\" VALUE = ")) + (((Integer) dvQuestRespondidoRespostas.getProperty(3)))) + (" UNCHECKED>")) : ((((("<INPUT TYPE=\"CHECKBOX\" NAME=\"CB") + (((Integer) dvQuestRespondidoRespostas.getProperty(3)))) + ("\" VALUE = ")) + (((Integer) dvQuestRespondidoRespostas.getProperty(3)))) + (" CHECKED>")))) : ("");

				case 20:
					/* lblQR_DscResp () vw_ss_respostas_preenchidas.dsc_resposta*/
					return ((String) dvQuestRespondidoRespostas.getProperty(1));

				case 21:
					/* lblQR_SeqResp () vw_ss_respostas_preenchidas.seq_resp*/
					return ((Integer) dvQuestRespondidoRespostas.getProperty(3));

				case 22:
					/* lblQR_Aberta () if (pergunta.idt_campo_descritivo = true) and (pergunta.qtd_resp = 0) then if vw_ss_respostas_preenchidas.dsc_resp not isnull then "<TEXTAREA NAME=\"TX" + vw_ss_respostas_preenchidas.seq_per + "\" " + " ROWS=\"3\" COLS=\"70\"> " + vw_ss_respostas_preenchidas.dsc_resp + " </TEXTAREA>" else "<TEXTAREA NAME=\"TX" + vw_ss_respostas_preenchidas.seq_per + "\" " + " ROWS=\"3\" COLS=\"70\"> </TEXTAREA>" endif else " " endif*/
					return ((((Boolean) dvQuestRespondidoPerguntas.getProperty(4)).booleanValue() == true) && (((Integer) dvQuestRespondidoPerguntas.getProperty(3)).intValue() == 0)) ? ( !((((String) dvQuestRespondidoRespostas.getProperty(5)) == null ? true : false)) ? (((((("<TEXTAREA NAME=\"TX") + (((Integer) dvQuestRespondidoRespostas.getProperty(0)))) + ("\" ")) + (" ROWS=\"3\" COLS=\"70\"> ")) + (((String) dvQuestRespondidoRespostas.getProperty(5)))) + (" </TEXTAREA>")) : (((("<TEXTAREA NAME=\"TX") + (((Integer) dvQuestRespondidoRespostas.getProperty(0)))) + ("\" ")) + (" ROWS=\"3\" COLS=\"70\"> </TEXTAREA>"))) : (" ");

				case 23:
					/* lblQR_QtdResp () vw_ss_respostas_preenchidas.qtd_resp*/
					return ((Integer) dvQuestRespondidoRespostas.getProperty(6));

				case 24:
					/* lblQR_SeqPer () vw_ss_respostas_preenchidas.seq_per*/
					return ((Integer) dvQuestRespondidoRespostas.getProperty(0));

				case 25:
					/* lblQR_SeqResp01 () vw_ss_respostas_preenchidas.seq_resp*/
					return ((Integer) dvQuestRespondidoRespostas.getProperty(3));

				case 26:
					/* lblQR_CodQuestionario () vw_ss_respostas_preenchidas.questionario_cod_questionario*/
					return ((Integer) dvQuestRespondidoRespostas.getProperty(2));

				case 27:
					/* lbQR_CodAluno () vw_ss_respostas_preenchidas.cod_aluno*/
					return ((Integer) dvQuestRespondidoRespostas.getProperty(4));

				case 28:
					/* lblQnR_SeqPer00 () pergunta.seq_per*/
					return ((Integer) dvQuestNaoRespondidoPerguntas.getProperty(0));

				case 29:
					/* lblQnR_SeqQuest () pergunta.questionario_cod_questionario*/
					return ((Integer) dvQuestNaoRespondidoPerguntas.getProperty(4));

				case 30:
					/* lblQnR_DscPergunta () pergunta.dsc_pergunta*/
					return ((String) dvQuestNaoRespondidoPerguntas.getProperty(3));

				case 31:
					/* lblQnR_Op () if vw_ss_respostas_nao_preenchidas.qtd_resp <> 0 then if vw_ss_respostas_nao_preenchidas.qtd_resp = 1 then "<INPUT TYPE=\"RADIO\" NAME=\"RB" + vw_ss_respostas_nao_preenchidas.seq_per + "\" VALUE = " + vw_ss_respostas_nao_preenchidas.seq_resp + " UNCHECKED>" else "<INPUT TYPE=\"CHECKBOX\" NAME=\"CB" + vw_ss_respostas_nao_preenchidas.seq_resp + "\" VALUE = " + vw_ss_respostas_nao_preenchidas.seq_resp + " UNCHECKED>" endif else "" endif*/
					return (((Integer) dvQuestNaoRespondidoRespostas.getProperty(2)).intValue() != 0) ? ((((Integer) dvQuestNaoRespondidoRespostas.getProperty(2)).intValue() == 1) ? ((((("<INPUT TYPE=\"RADIO\" NAME=\"RB") + (((Integer) dvQuestNaoRespondidoRespostas.getProperty(1)))) + ("\" VALUE = ")) + (((Integer) dvQuestNaoRespondidoRespostas.getProperty(0)))) + (" UNCHECKED>")) : ((((("<INPUT TYPE=\"CHECKBOX\" NAME=\"CB") + (((Integer) dvQuestNaoRespondidoRespostas.getProperty(0)))) + ("\" VALUE = ")) + (((Integer) dvQuestNaoRespondidoRespostas.getProperty(0)))) + (" UNCHECKED>"))) : ("");

				case 32:
					/* lblQnR_DscResp () vw_ss_respostas_nao_preenchidas.dsc_resposta*/
					return ((String) dvQuestNaoRespondidoRespostas.getProperty(4));

				case 33:
					/* lblQnR_SeqResp () vw_ss_respostas_nao_preenchidas.seq_resp*/
					return ((Integer) dvQuestNaoRespondidoRespostas.getProperty(0));

				case 34:
					/* lblQnR_Aberta () if (pergunta.idt_campo_descritivo = true) and (pergunta.qtd_resp = 0) then "<TEXTAREA NAME=\"TX" + vw_ss_respostas_nao_preenchidas.seq_per + "\" " + " ROWS=\"3\" COLS=\"70\"> </TEXTAREA>" else " " endif*/
					return ((((Boolean) dvQuestNaoRespondidoPerguntas.getProperty(1)).booleanValue() == true) && (((Integer) dvQuestNaoRespondidoPerguntas.getProperty(2)).intValue() == 0)) ? (((("<TEXTAREA NAME=\"TX") + (((Integer) dvQuestNaoRespondidoRespostas.getProperty(1)))) + ("\" ")) + (" ROWS=\"3\" COLS=\"70\"> </TEXTAREA>")) : (" ");

				case 35:
					/* lblQnR_QtdResp () vw_ss_respostas_nao_preenchidas.qtd_resp*/
					return ((Integer) dvQuestNaoRespondidoRespostas.getProperty(2));

				case 36:
					/* lblQnR_SeqPer () vw_ss_respostas_nao_preenchidas.seq_per*/
					return ((Integer) dvQuestNaoRespondidoRespostas.getProperty(1));

				case 37:
					/* lblQnR_SeqResp01 () vw_ss_respostas_nao_preenchidas.seq_resp*/
					return ((Integer) dvQuestNaoRespondidoRespostas.getProperty(0));

				case 38:
					/* lblQnR_CodQuestionario () vw_ss_respostas_nao_preenchidas.questionario_cod_questionario*/
					return ((Integer) dvQuestNaoRespondidoRespostas.getProperty(3));

				case 39:
					/* lblQuestaoMultiploCampoAbertoPreenchido () if (pergunta.idt_campo_descritivo = true) and (pergunta.qtd_resp > 0) then if vw_ss_respostas_preenchidas.dsc_resp isnull then "<input name='fld" + vw_ss_respostas_preenchidas.seq_resp + "' type='text' value='' size='50' maxlength='50'>" else "<input name='fld" + vw_ss_respostas_preenchidas.seq_resp + "' type='text' value='" + vw_ss_respostas_preenchidas.dsc_resp + "' size='50' maxlength='50'>" endif else "" endif*/
					return ((((Boolean) dvQuestRespondidoPerguntas.getProperty(4)).booleanValue() == true) && (((Integer) dvQuestRespondidoPerguntas.getProperty(3)).intValue() > 0)) ? (((((String) dvQuestRespondidoRespostas.getProperty(5)) == null ? true : false)) ? ((("<input name='fld") + (((Integer) dvQuestRespondidoRespostas.getProperty(3)))) + ("' type='text' value='' size='50' maxlength='50'>")) : ((((("<input name='fld") + (((Integer) dvQuestRespondidoRespostas.getProperty(3)))) + ("' type='text' value='")) + (((String) dvQuestRespondidoRespostas.getProperty(5)))) + ("' size='50' maxlength='50'>"))) : ("");

				case 40:
					/* lblQuestaoMultiploCampoAberto () if (pergunta.idt_campo_descritivo = true) and (pergunta.qtd_resp > 0) then "<input name='fld" + vw_ss_respostas_nao_preenchidas.seq_resp + "' type='text' value='' size='50' maxlength='50'>" else "" endif*/
					return ((((Boolean) dvQuestNaoRespondidoPerguntas.getProperty(1)).booleanValue() == true) && (((Integer) dvQuestNaoRespondidoPerguntas.getProperty(2)).intValue() > 0)) ? ((("<input name='fld") + (((Integer) dvQuestNaoRespondidoRespostas.getProperty(0)))) + ("' type='text' value='' size='50' maxlength='50'>")) : ("");

				default:
					return null;
			}
		}
		catch (Throwable e)
		{
			return null;
		}
	}
	
	protected void addExpDependencies()
	{
		//==== Warning: SilverStream-generated method: do not edit. All changes will be lost ===
		agDataMgr.addExpDataDependency(40, dvQuestNaoRespondidoPerguntas, 1, false);
		agDataMgr.addExpDataDependency(40, dvQuestNaoRespondidoPerguntas, 2, false);
		agDataMgr.addExpDataDependency(40, dvQuestNaoRespondidoRespostas, 0, false);
		agDataMgr.addExpDataDependency(39, dvQuestRespondidoPerguntas, 4, false);
		agDataMgr.addExpDataDependency(39, dvQuestRespondidoPerguntas, 3, false);
		agDataMgr.addExpDataDependency(39, dvQuestRespondidoRespostas, 5, false);
		agDataMgr.addExpDataDependency(39, dvQuestRespondidoRespostas, 3, false);
		agDataMgr.addExpDataDependency(38, dvQuestNaoRespondidoRespostas, 3, false);
		agDataMgr.addExpDataDependency(37, dvQuestNaoRespondidoRespostas, 0, false);
		agDataMgr.addExpDataDependency(36, dvQuestNaoRespondidoRespostas, 1, false);
		agDataMgr.addExpDataDependency(35, dvQuestNaoRespondidoRespostas, 2, false);
		agDataMgr.addExpDataDependency(34, dvQuestNaoRespondidoPerguntas, 1, false);
		agDataMgr.addExpDataDependency(34, dvQuestNaoRespondidoPerguntas, 2, false);
		agDataMgr.addExpDataDependency(34, dvQuestNaoRespondidoRespostas, 1, false);
		agDataMgr.addExpDataDependency(33, dvQuestNaoRespondidoRespostas, 0, false);
		agDataMgr.addExpDataDependency(32, dvQuestNaoRespondidoRespostas, 4, false);
		agDataMgr.addExpDataDependency(31, dvQuestNaoRespondidoRespostas, 2, false);
		agDataMgr.addExpDataDependency(31, dvQuestNaoRespondidoRespostas, 1, false);
		agDataMgr.addExpDataDependency(31, dvQuestNaoRespondidoRespostas, 0, false);
		agDataMgr.addExpDataDependency(30, dvQuestNaoRespondidoPerguntas, 3, false);
		agDataMgr.addExpDataDependency(29, dvQuestNaoRespondidoPerguntas, 4, false);
		agDataMgr.addExpDataDependency(28, dvQuestNaoRespondidoPerguntas, 0, false);
		agDataMgr.addExpDataDependency(27, dvQuestRespondidoRespostas, 4, false);
		agDataMgr.addExpDataDependency(26, dvQuestRespondidoRespostas, 2, false);
		agDataMgr.addExpDataDependency(25, dvQuestRespondidoRespostas, 3, false);
		agDataMgr.addExpDataDependency(24, dvQuestRespondidoRespostas, 0, false);
		agDataMgr.addExpDataDependency(23, dvQuestRespondidoRespostas, 6, false);
		agDataMgr.addExpDataDependency(22, dvQuestRespondidoPerguntas, 4, false);
		agDataMgr.addExpDataDependency(22, dvQuestRespondidoPerguntas, 3, false);
		agDataMgr.addExpDataDependency(22, dvQuestRespondidoRespostas, 5, false);
		agDataMgr.addExpDataDependency(22, dvQuestRespondidoRespostas, 0, false);
		agDataMgr.addExpDataDependency(21, dvQuestRespondidoRespostas, 3, false);
		agDataMgr.addExpDataDependency(20, dvQuestRespondidoRespostas, 1, false);
		agDataMgr.addExpDataDependency(19, dvQuestRespondidoRespostas, 6, false);
		agDataMgr.addExpDataDependency(19, dvQuestRespondidoRespostas, 7, false);
		agDataMgr.addExpDataDependency(19, dvQuestRespondidoRespostas, 0, false);
		agDataMgr.addExpDataDependency(19, dvQuestRespondidoRespostas, 3, false);
		agDataMgr.addExpDataDependency(18, dvQuestRespondidoPerguntas, 1, false);
		agDataMgr.addExpDataDependency(17, dvQuestRespondidoPerguntas, 2, false);
		agDataMgr.addExpDataDependency(16, dvQuestRespondidoPerguntas, 0, false);
	}

	




































protected void pageRequestBegin(AgiHttpServletRequest req, AgiHttpServletResponse res) throws Exception
	{
	
	try
	{
//setSessionValue("vsCodAluno", "" +  206393); // nao tem
//setSessionValue("vsCodAluno", "" +  206379); // tem
//setSessionValue("vsCodAluno", "" +  999999); 

  
		lblNome.setText ((String)getSessionValue("vsNomeAluno"));
 
		if( getSessionValue("vsCodAluno") == null )
		{
			showPage("pgQeLogin.html");
			return;
		}
		else
		{
			tabQuestRespondido.setEnableHTMLGeneration(false);
			tabQuestNMaoRespondido.setEnableHTMLGeneration(false);
		}


	}
	catch(Exception e)
	{
	    String sMETODO = " - Exception pageRequestBegin  ......";
	    // CHAMA boEnivaMsgConsole
	    Hashtable hs = new Hashtable();
	    hs.put("pIdentificador", sSISTEMA + sPAGINA + sMETODO);
	    hs.put("pException", e);
	    invokeBusinessObject("Util:boEnviaMsgConsole", hs);
	}
	

	}
//FIM GRAVA RESPOSTAS ---------------------------------------------------------------------

public void pageActionPerformed(ActionEvent evt) throws Exception
	{
		//==== Warning: SilverStream-generated method: do not edit. All changes will be lost ===
		Object src = evt.getSource();
		if (src == brnsalvar)
		{
			handle_brnsalvar_pageActionPerformed(evt);
			return;
		}
	}

	public void excluiRespostasCheck(int seq_per)
		throws Exception
	{
	
	try {
			// Exclui todas as respostas gravadas
			agpPerguntaResposta.query("pergunta_resposta.questionario_cod_questionario = 1 " 
							   + " and pergunta_resposta.pergunta_seq_per =  " + seq_per);
			
			if (agpPerguntaResposta.gotoFirst())
			{
				do
				{
					agpPerguntaResposta.delete();
					
				} while (agpPerguntaResposta.gotoFirst());
			}
			agpPerguntaResposta.updateRows();
		}
		catch (Exception e)		{
			System.out.println("EGR - Erro ao excluir respostas check:" + e);
		}
	
	
	}

	
public void agpDataPerguntaRespostaAux()
		throws Exception
	{
	}

	









public void carregaQuestionarioNaoRespondido()
		throws Exception
	{
	try
	{
		dvQuestNaoRespondidoPerguntas.query("pergunta.questionario_cod_questionario = 1");

		// Buscando as respostas possíveis 
		StringBuffer sSQL = new StringBuffer();
		sSQL.append("vw_ss_respostas_nao_preenchidas.questionario_cod_questionario = " + new Integer((int)(1)) );

		dvQuestNaoRespondidoRespostas.query(sSQL.toString(), "vw_ss_respostas_nao_preenchidas.seq_resp");

	}
	catch(Exception e)
	{
		String sMETODO = " - General.carregaQuestionarioNaoRespondido";

		// CHAMA boEnivaMsgConsole
		Hashtable hs = new Hashtable();
		hs.put("pIdentificador", sSISTEMA + sPAGINA + sMETODO);
		hs.put("pException", e);
		invokeBusinessObject("Util:boEnviaMsgConsole", hs);
	}
	}

	





public void carregaQuestionarioRespondido()
		throws Exception
	{
	try
	{
		dvQuestRespondidoPerguntas.query("pergunta.questionario_cod_questionario = 1");

		// Buscando as respostas possíveis 
		StringBuffer sSQL = new StringBuffer();
		sSQL.append(" vw_ss_respostas_preenchidas.questionario_cod_questionario = 1 " + 
					" and (vw_ss_respostas_preenchidas.cod_aluno = " + getSessionValue("vsCodAluno") +
					" 	   or vw_ss_respostas_preenchidas.cod_aluno isnull)");

		dvQuestRespondidoRespostas.query(sSQL.toString(), "vw_ss_respostas_preenchidas.seq_resp");

	}
	catch(Exception e)
	{
		String sMETODO = " - General.carregaQuestionarioRespondido";

		// CHAMA boEnivaMsgConsole
		Hashtable hs = new Hashtable();
		hs.put("pIdentificador", sSISTEMA + sPAGINA + sMETODO);
		hs.put("pException", e);
		invokeBusinessObject("Util:boEnviaMsgConsole", hs);
	}

	}

	




public void atualizarQuestionario()
		throws Exception
	{
try
{
	dvQuestRespondidoPerguntas.query("pergunta.questionario_cod_questionario = 1");
	
	AgiRowCursor LinhaCorrente = (AgiRowCursor) dvQuestRespondidoPerguntas.getCurrentRowCursor();
	LinhaCorrente.gotoFirst();
			
	do 
	{
		int qResp =((Integer) LinhaCorrente.getProperty("pergunta.qtd_resp")).intValue();

		//RAdio Button ---------------------------------------------------------------------		
		if(qResp == 1 )
		{

			// Monta nome do controle
			String idControle = "RB" + LinhaCorrente.getProperty("pergunta.seq_per");

			// Pega controle RADIOBUTTON passado como parâmetro
			String[] valor = getCurrentRequest().getParameterValues(idControle);
			
			// Verificando se está atualizando ou inserindo
			StringBuffer sSQL = new StringBuffer();

			sSQL.append("pergunta_resposta.cod_aluno = " + getSessionValue("vsCodAluno") +
						" and pergunta_resposta.questionario_cod_questionario = 1 " +
						" and pergunta_resposta.pergunta_seq_per = " +  LinhaCorrente.getProperty("pergunta.seq_per"));
			
			agpPerguntaResposta.query(sSQL.toString());
 
			if(getCurrentRequest().getParameterValues(idControle) != null)
			{
				if (! agpPerguntaResposta.gotoFirst())
				{
					agpPerguntaResposta.insertAfter();
				}
				else
				{
					agpPerguntaResposta.query(sSQL.toString());
				}	
				
				agpPerguntaResposta.setProperty("cod_aluno", getSessionValue("vsCodAluno"));
				agpPerguntaResposta.setProperty("questionario_cod_questionario", "" + lblQR_SeqQuest.getText());
				agpPerguntaResposta.setProperty("pergunta_seq_per", "" + LinhaCorrente.getProperty("pergunta.seq_per"));			
				agpPerguntaResposta.setProperty("resposta_seq_resp",new Integer(valor[0]));
				agpPerguntaResposta.setProperty("dsc_resp",null);  
				
			}//if 
			
		} //fim if(qResp == 1 )
	


		//CheckBox ------------------------------------------------------------------------
		if(qResp > 1)
		{
			excluiRespostasCheck(((Integer) LinhaCorrente.getProperty("pergunta.seq_per")).intValue());

			int per = ((Integer)LinhaCorrente.getProperty("pergunta.seq_per")).intValue();

//    dvQuestRespondidoRespostas.query("vw_ss_respostas.seq_per =  " + per);
		
			AgiRowCursor LinhaRespCorrente = (AgiRowCursor) dvQuestRespondidoRespostas.getCurrentRowCursor();
	
			LinhaRespCorrente.gotoFirst();	
	
			agpRespostas.query("respostas.seq_per = " + per);
	
			if (agpRespostas.gotoFirst())
			{
				do
				{
					// Monta nome do controle
//			  		String idControle = "CB" + LinhaRespCorrente.getProperty("vw_ss_respostas.seq_resp");
					String idControle = "CB" + agpRespostas.getProperty("seq_resp");
					String idFldControle = "fld" + agpRespostas.getProperty("seq_resp");
			
					// Pega controle RADIOBUTTON passado como parâmetro
					if(getCurrentRequest().getParameterValues(idControle)!= null)
					{
						String valor[] = getCurrentRequest().getParameterValues(idControle);
	    
						agpPerguntaResposta.insertAfter();
						agpPerguntaResposta.setProperty("cod_aluno", getSessionValue("vsCodAluno"));
						agpPerguntaResposta.setProperty("questionario_cod_questionario", "" + lblQR_SeqQuest.getText());
						agpPerguntaResposta.setProperty("pergunta_seq_per", "" + LinhaCorrente.getProperty("pergunta.seq_per"));			
						agpPerguntaResposta.setProperty("resposta_seq_resp",new Integer(valor[0]));
						
						// se existe um fld associado ao checkbox, entao grava a resposta
						if (getCurrentRequest().getParameterValues(idFldControle) != null) {
							agpPerguntaResposta.setProperty("dsc_resp", getCurrentRequest().getParameterValues(idFldControle)[0]);  
						}
						else {
							agpPerguntaResposta.setProperty("dsc_resp",null);  
						}
					}
					
					
	
					LinhaRespCorrente.gotoNext();	
		
				} while( agpRespostas.gotoNext());
  
			} // if (agpRespostas.gotoFirst())

		} //fim if 
	 

		//Descritiva resposta -------------------------------------------------------------
		if(qResp ==  0)
		{
			// Monta nome do controle
			String idControle = "TX" + LinhaCorrente.getProperty("pergunta.seq_per");
	
			// Pega controle Descritivo
			String[] valor = getCurrentRequest().getParameterValues(idControle);
			      
			// Verificando se está atualizando ou inserindo
			StringBuffer sSQL = new StringBuffer();
		
			sSQL.append("pergunta_resposta.cod_aluno = " + getSessionValue("vsCodAluno") +
						" and pergunta_resposta.questionario_cod_questionario = 1 " +
						" and pergunta_resposta.pergunta_seq_per = " +  LinhaCorrente.getProperty("pergunta.seq_per"));
			
			agpPerguntaResposta.query(sSQL.toString());

			if(getCurrentRequest().getParameterValues(idControle) != null)
			{	
				if (! agpPerguntaResposta.gotoFirst()) 
				{
					agpPerguntaResposta.insertAfter();
				}
				else
				{	
					agpPerguntaResposta.query(sSQL.toString());       
				}
				
				agpPerguntaResposta.setProperty("cod_aluno", getSessionValue("vsCodAluno"));
				agpPerguntaResposta.setProperty("questionario_cod_questionario", "" + lblQR_SeqQuest.getText());
				agpPerguntaResposta.setProperty("pergunta_seq_per", "" + LinhaCorrente.getProperty("pergunta.seq_per"));			
				agpPerguntaResposta.setProperty("resposta_seq_resp",new Integer(0));
				agpPerguntaResposta.setProperty("dsc_resp", valor[0]);  
			}
 	
		} //fim if 

//Fim respostas descritivas  --------------------


		agpPerguntaResposta.updateRows();    //atualiza a tabela		
		
						
	} while (LinhaCorrente.gotoNext()); 		

	agScriptHelper.alert("Dados atualizados com sucesso.");


}
catch(Exception e)
{
	System.out.println("ERRO EGR : " + e);
}
	}

	






public void salvarQuestionario()
		throws Exception
	{
	try
	{
		dvQuestNaoRespondidoPerguntas.query("pergunta.questionario_cod_questionario = 1");
		
		AgiRowCursor LinhaCorrente = (AgiRowCursor) dvQuestNaoRespondidoPerguntas.getCurrentRowCursor();
		LinhaCorrente.gotoFirst();
				
		do 
		{
			int qResp =((Integer) LinhaCorrente.getProperty("pergunta.qtd_resp")).intValue();

			//RAdio Button ---------------------------------------------------------------------		

			if(qResp == 1 )
			{
				// Monta nome do controle
				String idControle = "RB" + LinhaCorrente.getProperty("pergunta.seq_per");
				
				// Pega controle RADIOBUTTON passado como parâmetro
				String[] valor = getCurrentRequest().getParameterValues(idControle);
				
				// Verificando se está atualizando ou inserindo
				StringBuffer sSQL = new StringBuffer();

				sSQL.append("pergunta_resposta.cod_aluno = " + getSessionValue("vsCodAluno") +
							" and pergunta_resposta.questionario_cod_questionario = 1 " +
							" and pergunta_resposta.pergunta_seq_per = " +  LinhaCorrente.getProperty("pergunta.seq_per"));
				
				agpPerguntaResposta.query(sSQL.toString());
	 
				if(getCurrentRequest().getParameterValues(idControle) != null)
				{
					if (! agpPerguntaResposta.gotoFirst())
					{
						agpPerguntaResposta.insertAfter();
					}
					else
					{
						agpPerguntaResposta.query(sSQL.toString());
					}	
					
					agpPerguntaResposta.setProperty("cod_aluno", getSessionValue("vsCodAluno"));
					agpPerguntaResposta.setProperty("questionario_cod_questionario", "" + lblQnR_SeqQuest.getText());
					agpPerguntaResposta.setProperty("pergunta_seq_per", "" + LinhaCorrente.getProperty("pergunta.seq_per"));
					agpPerguntaResposta.setProperty("resposta_seq_resp", new Integer(valor[0]));
					agpPerguntaResposta.setProperty("dsc_resp", null);  
				}//if 
				
			} //fim if(qResp == 1 )
		


			//CheckBox ------------------------------------------------------------------------
			if(qResp > 1)
			{
				excluiRespostasCheck(((Integer) LinhaCorrente.getProperty("pergunta.seq_per")).intValue());

				int per = ((Integer)LinhaCorrente.getProperty("pergunta.seq_per")).intValue();

//    			dvQuestNaoRespondidoRespostas.query("vw_ss_respostas.seq_per =  " + per);
			
				AgiRowCursor LinhaRespCorrente = (AgiRowCursor) dvQuestNaoRespondidoRespostas.getCurrentRowCursor();
		
				LinhaRespCorrente.gotoFirst();	
		
				agpRespostas.query("respostas.seq_per = " + per);
		
				if (agpRespostas.gotoFirst())
				{
					do
					{
						// Monta nome do controle
	//			  		String idControle = "CB" + LinhaRespCorrente.getProperty("vw_ss_respostas.seq_resp");
						String idControle = "CB" + agpRespostas.getProperty("seq_resp");
						String idFldControle = "fld" + agpRespostas.getProperty("seq_resp");
				
						// Pega controle RADIOBUTTON passado como parâmetro
						if(getCurrentRequest().getParameterValues(idControle)!= null)
						{
							String valor[] = getCurrentRequest().getParameterValues(idControle);
		    
							agpPerguntaResposta.insertAfter();
							agpPerguntaResposta.setProperty("cod_aluno", getSessionValue("vsCodAluno"));
							agpPerguntaResposta.setProperty("questionario_cod_questionario", "" + lblQnR_SeqQuest.getText());
							agpPerguntaResposta.setProperty("pergunta_seq_per", "" + LinhaCorrente.getProperty("pergunta.seq_per"));
							agpPerguntaResposta.setProperty("resposta_seq_resp", new Integer(valor[0]));
							
							// se existe um fld associado ao checkbox, entao grava a resposta
							if (getCurrentRequest().getParameterValues(idFldControle) != null) {
								agpPerguntaResposta.setProperty("dsc_resp", getCurrentRequest().getParameterValues(idFldControle)[0]);  
							}
							else {
								agpPerguntaResposta.setProperty("dsc_resp",null);  
							}
						}
		
						LinhaRespCorrente.gotoNext();	
			
					} while( agpRespostas.gotoNext());
	  
				} // if (agpRespostas.gotoFirst())

			} //fim if 
		 

			//Descritiva resposta -------------------------------------------------------------
			if(qResp ==  0)
			{
				// Monta nome do controle
				String idControle = "TX" + LinhaCorrente.getProperty("pergunta.seq_per");
		
				// Pega controle Descritivo
				String[] valor = getCurrentRequest().getParameterValues(idControle);
				      
				// Verificando se está atualizando ou inserindo
				StringBuffer sSQL = new StringBuffer();
			
				sSQL.append("pergunta_resposta.cod_aluno = " + getSessionValue("vsCodAluno") +
							" and pergunta_resposta.questionario_cod_questionario = 1 " +
							" and pergunta_resposta.pergunta_seq_per = " +  LinhaCorrente.getProperty("pergunta.seq_per"));
				
				agpPerguntaResposta.query(sSQL.toString());

				if(getCurrentRequest().getParameterValues(idControle) != null)
				{	
					if (! agpPerguntaResposta.gotoFirst()) 
					{
						agpPerguntaResposta.insertAfter();
					}
					else
					{	
						agpPerguntaResposta.query(sSQL.toString());       
					}
					
					agpPerguntaResposta.setProperty("cod_aluno", getSessionValue("vsCodAluno"));
					agpPerguntaResposta.setProperty("questionario_cod_questionario", "" + lblQnR_SeqQuest.getText());
					agpPerguntaResposta.setProperty("pergunta_seq_per", "" + LinhaCorrente.getProperty("pergunta.seq_per"));			
					agpPerguntaResposta.setProperty("resposta_seq_resp",new Integer(0));
					agpPerguntaResposta.setProperty("dsc_resp", valor[0]);  
				}
	 	
			} //fim if 

			//Fim respostas descritivas  --------------------


			agpPerguntaResposta.updateRows();    //atualiza a tabela		
							
		} while (LinhaCorrente.gotoNext()); 		

		agScriptHelper.alert("Dados gravados com sucesso.");

	}
	catch(Exception e)
	{
		String sMETODO = " - General.salvaQuestionario";

		// CHAMA boEnivaMsgConsole
		Hashtable hs = new Hashtable();
		hs.put("pIdentificador", sSISTEMA + sPAGINA + sMETODO);
		hs.put("pException", e);
		invokeBusinessObject("Util:boEnviaMsgConsole", hs);
	}
	}

	



protected void pageGenerateBegin() throws Exception
	{
	try
	{
		tabQuestRespondido.setEnableHTMLGeneration(false);
		tabQuestNMaoRespondido.setEnableHTMLGeneration(false);


		// Tratamento para bug do SilverStream (Cláusula where vazia)
		if (getSessionValue("vsCodAluno") == null)
		{
			agpDataPerguntaRespostaAux.query("pergunta_resposta.questionario_cod_questionario = 0");
		}
		else
		{
			agpDataPerguntaRespostaAux.query("pergunta_resposta.questionario_cod_questionario = 1" +
											 " and pergunta_resposta.cod_aluno = " + getSessionValue("vsCodAluno"));


			if (agpDataPerguntaRespostaAux.gotoFirst())
			{
				tabQuestRespondido.setEnableHTMLGeneration(true);
				carregaQuestionarioRespondido();
//System.out.println("RESPONDIDO");
			}
			else
			{
				carregaQuestionarioNaoRespondido();
				tabQuestNMaoRespondido.setEnableHTMLGeneration(true);
//System.out.println("NÃO RESPONDIDO");
			}

		}
	
	}
	catch(Exception e)
	{
	    String sMETODO = " - pageGenerateBegin";
	    // CHAMA boEnivaMsgConsole
	    Hashtable hs = new Hashtable();
	    hs.put("pIdentificador", sSISTEMA + sPAGINA + sMETODO);
	    hs.put("pException", e);
	    invokeBusinessObject("Util:boEnviaMsgConsole", hs);
	}
	

	}
	
	
private void handle_brnsalvar_pageActionPerformed(ActionEvent evt)
		throws Exception
	
	{
	try
	{

		if (agpDataPerguntaRespostaAux.gotoFirst())
			atualizarQuestionario();
		else
			salvarQuestionario();

	}
	catch(Exception e)
	{
		System.out.println("ERRO EGR : " + e);
	}

	}


}
